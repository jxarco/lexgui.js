<script type="module">

    import { LX } from 'lexgui';

    docMaker.header( "Icons.", "h1", "icons" );

    docMaker.paragraph( `LexGUI makes use of ${ docMaker.iLink( "Lucide Icons", "https://lucide.dev/" ) }, check its documentation to know more. On top of that, LexGUI overrides some of the icons and offers a collection of solid variants, collected mostly from
    ${ docMaker.iLink( "FontAwesome", "https://fontawesome.com/" ) }, ${ docMaker.iLink( "SVGRepo", "https://www.svgrepo.com/" ) } and ${ docMaker.iLink( "Iconify.design", "https://iconify.design/" ) }:` );

    {
        const params = new URLSearchParams( document.location.search );
        const content = document.getElementById('content');
        const area = new LX.Area( { skipAppend: true, height: "auto" } );

        let showMoreButton = null;
        let forceSolid = false;
        let nameFilter = params.get( "filter" ) ?? "";

        function copySVG( svg, event )
        {
            navigator.clipboard.writeText( svg.dataset[ "name" ] + ( forceSolid ? "@solid" : "" ) );
            const msg = `${ svg.dataset[ "name" ] } icon copied to clipboard!`;
            console.log( msg );
            LX.toast( msg, null, { position: "top-center", timeout: 3000 } );
        }

        const toolsContainer = LX.makeContainer( ["100%", "auto"], "flex flex-row mt-8 mb-4 gap-2", "", area );

        const filterContainer = LX.makeContainer( ["auto", "auto"], "flex flex-auto-fill", "", toolsContainer );
        const filter = new LX.TextInput( null, "", (v) => {
            nameFilter = v;
            refreshIcons();
        }, { width: "100%", icon: "Search", placeholder: "Filter icons", trigger: "input" } );
        filterContainer.appendChild( filter.root );

        const iconsPerPage = 256;
        const paginationContainer = LX.makeContainer( ["auto", "auto"], "flex flex-row flex-auto", "", toolsContainer );
        const paginator = new LX.Pagination({
            page: 1,
            itemsPerPage: iconsPerPage,
            onChange: (page) => {
                refreshIcons();
            }
        });
        paginationContainer.appendChild( paginator.root );

        const variantContainer = LX.makeContainer( ["auto", "auto"], "flex flex-row flex-auto justify-end", "", toolsContainer );
        const variantToggle = new LX.Toggle( null, forceSolid, (v) => {
            forceSolid = v;
            refreshIcons();
        }, { label: "Solid Variant" } );
        variantContainer.appendChild( variantToggle.root );

        const allIcons = {
            ...LX.ICONS,
            ...lucide.icons
        }

        // Sort icons by name
        const allIconsSorted = Object.keys( allIcons ).sort();
        const allIconsContainer = LX.makeContainer( ["100%", "auto"], "grid mb-8 gap-2", "", area );
        allIconsContainer.style.gridTemplateColumns = "repeat(auto-fill, minmax(56px, 1fr))";

        const refreshIcons = () => {

            allIconsContainer.innerHTML = "";

            const filteredIcons = allIconsSorted.filter( i => {
                return !i.includes( '@' ) && i.toLowerCase().includes( nameFilter );
            } );
            const total = filteredIcons.length;
            const numPages = iconsPerPage === 1 ? 1 : Math.ceil( total / iconsPerPage );
            paginator.setPages( numPages );

            const start = ( paginator.page - 1 ) * iconsPerPage;
            const end = Math.min( start + iconsPerPage, total );

            for( let i = start; i < end; ++i )
            {
                const iconName = filteredIcons[ i ];
                const iconDiv = LX.makeContainer( ["56px", "56px"], "relative icon flex border rounded-lg content-center items-center justify-center cursor-pointer bg-primary hover:bg-tertiary", "", allIconsContainer );
                LX.asTooltip( iconDiv, iconName, { side: "bottom" } );

                const variant = forceSolid ? "solid" : "regular";
                const icon = LX.makeIcon( iconName, { iconClass: "flex justify-center items-center", svgClass: "absolute xxl pointer-events-none hover:fg-primary", variant });
                const checkIcon = LX.makeIcon( "Check", { iconClass: "opacity-0 flex justify-center items-center", svgClass: "absolute xxl pointer-events-none fg-success" });
                icon.style.transition = "opacity 0.2s ease-out";
                checkIcon.style.transition = "opacity 0.2s ease-out";
                LX.removeClass( icon, "lexicon" );
                LX.removeClass( checkIcon, "lexicon" );
                iconDiv.appendChild( icon );
                iconDiv.appendChild( checkIcon );
                const svg = icon.querySelector( "svg" );
                const checkSvg = icon.querySelector( "svg" );

                LX.listen( iconDiv, "click", () => {

                    LX.addClass( icon, "opacity-0" );
                    LX.removeClass( checkIcon, "opacity-0" );

                    copySVG( svg, event );

                    setTimeout( () => {
                        LX.addClass( checkIcon, "opacity-0" );
                        LX.removeClass( icon, "opacity-0" );
                    }, 2000 );
                } );
            }
        }

        refreshIcons();

        content.appendChild( area.root );
    }

    docMaker.paragraph( `If neither Lucide or LexGUI don't have the icon you are looking for, get the SVG string of your icon from anywhere (it must contain one path) and use ${ docMaker.iCode( "LX.registerIcon(name, svgString, variant, aliases)" ) }
    to allow using it inside LexGUI. ` );

    docMaker.lineBreak();
    docMaker.lineBreak();

    </script>

</body>