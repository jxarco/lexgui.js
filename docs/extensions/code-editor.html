<script type="text/javascript">

    MAKE_HEADER( "Code Editor.", "h1", "code-editor" );

    MAKE_PARAGRAPH( `Provides an embedded editing tool with syntax highlighting, line numbers, and editing conveniences like autocomplete and undo/redo.` );
    MAKE_LINE_BREAK();

    {
        const area = new LX.Area( { skipAppend: true, height: "500px" } );
        content.appendChild( area.root );
        let editor = new LX.CodeEditor( area, {
            files: [ "../data/js_sample.js" ]
        } );
        area.root.className += " border rounded-lg shadow-lg bg-secondary overflow-hidden";
    }

    MAKE_HEADER("Quick Usage", "h2");
    MAKE_PARAGRAPH( `The Code Editor component supports the following language highlightings:` );
    MAKE_CODE_BULLET_LIST( [
        "Plain text, Markdown",
        "HTML, CSS, JavaScript, TypeScript, JSON",
        "C, C++",
        "CMake",
        "WGSL, GLSL",
        "XML",
        "Rust",
        "Python",
        "Batch",
        "PHP"
    ] );

    MAKE_HEADER( "Creating the editor", "h3", "init" );

    MAKE_PARAGRAPH( `The Editor has to be appended to an existing area. It means that it can be created anywhere in the document window (e.g. dialogs, panels, areas, etc.), since to create an area it's as easy as instancing a new
    one. The following lines instantiate the DOM element for the editor:` );
    MAKE_CODE( `@let@ @[var]editor@ = @new@ @[cls]LX@.@[cls]CodeEditor@( @[var]area@, @[var]options@ );` );

    MAKE_HEADER( "Opening files and new tabs", "h3", "using-tabs" );
    MAKE_PARAGRAPH( `To load existing files you must use ${INLINE_CODE("CodeEditor.loadFile( filename, options )")}. This will open a new tab with the code in it using as options:` );
    MAKE_CODE_BULLET_LIST( [
        ["language", "String", "Override the language highlighting for the new loaded file"]
    ] );

    MAKE_PARAGRAPH( `Tab Events:` );
    MAKE_CODE_BULLET_LIST( [
        ["Double click to tab space", "Adds new empty tab"],
        ["Middle click to tab", "Closes tab"]
    ] );

    MAKE_HEADER( "Supporting new languages", "h3", "lang-support" );
    MAKE_PARAGRAPH(`It is allowed to register new languages with custom highlighting, reserved words, and parsing rules. Use the static method ${INLINE_CODE("CodeEditor.REGISTER_LANGUAGE(name, options, def, rules)")} to extend the editor with your own syntax support.`);

    MAKE_CODE_BULLET_LIST([
        ["name (String)", "Unique identifier for the language (e.g. 'myLang')."],
        ["options (Object)", "Configuration for extension, comment styles, case sensitivity, and other parsing options."],
        [
            ["ext (String)", "Default file extension for this language."],
            ["blockComments (Boolean)", "Whether block comments are supported."],
            ["blockCommentsTokens (Array<String>)", "Tokens marking the start and end of block comments."],
            ["singleLineComments (Boolean)", "Whether single-line comments are supported."],
            ["singleLineCommentToken (String)", "The token used for single-line comments."],
            ["numbers (Boolean)", "Enable automatic highlighting of numeric literals."],
            ["tags (Boolean)", "Enable highlighting of HTML/XML-style tags."],
            ["usePreprocessor (Boolean)", "Highlight tokens starting with `#`."],
            ["ignoreCase (Boolean)", "Treat keywords and identifiers as case-insensitive."],
            ["icon (String|Object)", "Default LexGUI icon with CSS classes (per extension)"],
        ],
        ["def (Object)", "Collections of reserved words to categorize tokens. Each property is an array of words"],
        [
            ["keywords", "Reserved language keywords (e.g. 'const', 'var', 'public')."],
            ["utils", "Utility functions or helpers."],
            ["types", "Type identifiers (e.g. 'int', 'string')."],
            ["builtIn", "Built-in functions or constants."],
            ["statements", "Control statements."],
            ["symbols", "Special symbols or operators."],
        ],
        ["rules (Array)", "List of token-matching rules for custom syntax highlighting."],
    ]);

    // Rules
    MAKE_HEADER("Highlight Rules", "h3");
    MAKE_PARAGRAPH(`The ${INLINE_CODE("rules")} array contains objects describing how to highlight tokens. Each rule has a ${INLINE_CODE("test")} function, an optional ${INLINE_CODE("action")}, and a ${INLINE_CODE("className")} to apply.`);
    MAKE_CODE(`[
  { test: ctx => ctx.inBlockComment, className: @"cm-com"@ },
  { test: ctx => ctx.inString, action: (ctx, editor) => editor.@[mtd]_appendStringToken@(ctx.token), discard: @true@ },
  { test: ctx => ctx.token.@[mtd]startsWith@(ctx.singleLineCommentToken), className: @"cm-com"@ },
  { test: (ctx, editor) => editor.@[mtd]_isKeyword@(ctx), className: @"cm-kwd"@ },
  { test: (ctx, editor) => editor.@[mtd]_mustHightlightWord@(ctx.token, CodeEditor.types, ctx.lang), className: @"cm-typ"@ },
  { test: (ctx, editor) => editor.@[mtd]_isNumber@(ctx.token), className: @"cm-dec"@ },
  { test: ctx => ctx.lang.usePreprocessor && ctx.token.@[mtd]includes@(@'#'@), className: @"cm-ppc"@ }
];`, "js");

    MAKE_NOTE(`The ${INLINE_CODE("discard")} option is used to skip the token, and the result of any action will be stored in ${INLINE_CODE("ctx.discardToken")}.`, false, "Tip", "Info");

    // Example
    MAKE_HEADER("Example: Registering a Custom Language", "h3");
    MAKE_CODE(`@[cls]CodeEditor@.REGISTER_LANGUAGE(@"mylang"@, {
    ext: [ @"ml"@, @"mlb"@ ],
    singleLineComments: @true@,
    singleLineCommentToken: @"//"@,
    blockComments: @true@,
    blockCommentsTokens: [@"/*"@, @"*/"@],
    numbers: @true@,
    ignoreCase: @true@,
    icon: { ml: @"Box fg-primary"@, mlb: @"Sphere violet"@ }
}, {
    types: [@"int"@, @"float"@, @"string"@],
    builtIn: [@"print"@, @"len"@]
    statements: [@"if"@, @"else"@, @"for"@, @"while"@],
}, [
    { test: ctx => ctx.inBlockComment, className: @"cm-com"@ },
    { test: (ctx, editor) => editor.@[mtd]_isKeyword@(ctx), className: @"cm-kwd"@ }
]);`, "js");

    // Tip
    MAKE_NOTE("Start with basic keyword and comment highlighting, then extend rules as needed. This modular approach makes it easier to debug syntax definitions.", false, "Tip", "Info");

    MAKE_HEADER("API Reference", "h2");
    MAKE_CLASS_CONSTRUCTOR( "class LX.CodeEditor", [
        ["area", "LX.Area"],
        ["options", "Object"]
    ] );
    MAKE_LINE_BREAK();
    MAKE_PARAGRAPH(`Where ${ INLINE_CODE( "area" ) } is the area to be attached to, and ${ INLINE_CODE( "options" ) } can include the following:`);
    MAKE_LINE_BREAK();

    {
        const area = new LX.Area( { skipAppend: true, height: "auto", className: "mb-6" } );
        const panel = area.addPanel();
        content.appendChild( area.root );
        panel.addTable( null, {
            head: [ "Option", "Type", "Description", "Default" ],
            body: [
                ["allowAddScripts", "Boolean", "Enables/Disables adding new tabs on dbl-click; skip 'New tab' button", "true"],
                ["allowClosingTabs", "Boolean", "Enables/Disables closing tabs", "true"],
                ["allowLoadingFiles", "Boolean", "Enables/Disables loading tabs from file", "true"],
                ["autocomplete", "Boolean", "Toggle using autocomplete tool", "true"],
                ["customSuggestions", "Array", "Custom word list for autocomplete", "—"],
                ["defaultTab", "Boolean", "Toggles the addition of the default tab", "true"],
                ["disableEdition", "Boolean", "Disables the edition of code (To make code snippets)", "false"],
                ["files", "Array", "List of files to load on start the editor"],
                ["filesAsync", "Array", "List of files to load asynchronally on start the editor"],
                ["fileExplorer", "Boolean", "Create a file explorer for the editor", "false"],
                ["highlight", "String", "Default highlighting", `"Plain Text"`],
                ["name", "String", "If defined, name of the default code tab", "—"],
                ["newTabOptions", "Array", "To use a custom Dropdown on click _New tab +_ button", "—"],
                ["onContextMenu", "Function", "Function to add custom actions on opening CM at any content", "—"],
                ["onCtrlSpace", "Function", "Code to call when pressing <code class='inline'>Ctrl+Space</code> in the editor", "—"],
                ["onCreateStatusPanel", "Function", "Code to call when the status bar is created to add custom elements", "—"],
                ["onNewTab", "Function", "Function to skip default action on click _New tab +_ button", "—"],
                ["onSave", "Function", "Code to call when pressing <code class='inline'>Ctrl+S</code> in the editor", "—"],
                ["onRun", "Function", "Code to call when pressing <code class='inline'>Ctrl+Enter</code> in the editor", "—"],
                ["statusShowEditorFilename", "Boolean", "Show Filename in info status bar", "true"],
                ["statusShowEditorIndentation", "Boolean", "Show Indentation in info status bar", "true"],
                ["statusShowEditorLanguage", "Boolean", "Show Language in info status bar", "true"],
                ["statusShowEditorSelection", "Boolean", "Show Selection line/position in info status bar", "true"],
                ["statusShowFontSizeZoom", "Boolean", "Show Font Size Zoom in info status bar", "true"],
                ["skipInfo", "Boolean", "Show or hide the editor status bar panel at the bottom (Zoom, Line, Column, etc.)", "false"],
                ["skipTabs", "Boolean", "Don't use tab-style editor for showing opened files", "false"],
            ].map( v => {
                return [ INLINE_CODE( v[ 0 ], "table" ), INLINE_CODE( v[ 1 ], "table desc" ), v[ 2 ], v[ 3 ] != "—" ? INLINE_CODE( v[ 3 ], "table desc" ) : v[ 3 ] ];
            } )
        }, {});
    }

    MAKE_LINE_BREAK();
    MAKE_LINE_BREAK();

</script>